language: c

sudo: required
dist: trusty

compiler:
  - gcc

script:
  - cmake -DCMAKE_BUILD_TYPE=Debug -DBUILD_EXAMPLES=On -DCMAKE_C_COMPILER=/usr/bin/gcc-7 -DUSE_TESTS=Off . 
  - make && make test && make clean
  - build-wrapper-linux-x86-64 --out-dir bw-output make && sonar-scanner

notifications:
  email: false

addons:
  sonarcloud:
    organization: "katajakasa-github"
  apt:
    sources:
    - sourceline: 'ppa:ubuntu-toolchain-r/test'
    - sourceline: 'ppa:george-edison55/cmake-3.x'
    - sourceline: 'ppa:jonathonf/ffmpeg-3'
    packages:
    - cmake
    - gcc-7
    - libsdl2-dev
    - libass-dev
    - ffmpeg

cache:
  directories:
    - '$HOME/.sonar/cache'
